"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[1502],{55484:(e,t,r)=>{r.d(t,{Z:()=>Y});var n=r(67294),o=r(24011),s=r(14890),i=r(63274),a=r(61366),l=r(5934),c=r(77297),u=r(74008),d=r(81034),p=r(11157),g=r(52835),y=r(39905),h=r(75708),f=r(98049),m=r(65914),E=r(51405),S=r(44187),D=r(170),v=r(94898),T=r(36146),w=r(54820),C=r(31300),M=r(61284),R=r(36808),F=r(26651),B=r(19412),b=r(54767),L=r(94315),P=r(310),x=r(19990),A=r(4137),k=r(94968),G=r(36374),Z=r(65186);e=r.hmd(e);var O,N=r(25108);function H(e){return L.T&&e&&e.perspectiveSettings&&e.perspectiveSettings[A.TU.GRID]?e.perspectiveSettings[A.TU.GRID]:JSON.parse(localStorage.getItem(x.defaultSettings.settingsKey))}function I(e){const t=L.T&&e.directoryMeta&&e.directoryMeta.perspectiveSettings&&e.directoryMeta.perspectiveSettings[A.TU.GRID],r=H(e.directoryMeta),[o,s]=(0,n.useState)(void 0),[a,u]=(0,n.useState)(void 0),d=(0,n.useRef)(void 0),E=(0,n.useRef)(null),[S,D]=(0,n.useState)(null),[M,O]=(0,n.useState)(null),[I,z]=(0,n.useState)(null),[U,X]=(0,n.useState)(null),[Y,K]=(0,n.useState)(null),[J,j]=(0,n.useState)(void 0),V=(0,n.useRef)(r&&r.sortBy?r.sortBy:x.defaultSettings.sortBy),W=(0,n.useRef)(r&&void 0!==r.orderBy?r.orderBy:x.defaultSettings.orderBy),$=(0,n.useRef)(e.lastSearchTimestamp?G.Z.results:e.directoryContent),q=(0,n.useRef)(r&&r.layoutType?r.layoutType:x.defaultSettings.layoutType),Q=(0,n.useRef)(r&&r.singleClickAction?r.singleClickAction:x.defaultSettings.singleClickAction),_=(0,n.useRef)(r&&r.entrySize?r.entrySize:x.defaultSettings.entrySize),ee=(0,n.useRef)(r&&r.thumbnailMode?r.thumbnailMode:x.defaultSettings.thumbnailMode),te=(0,n.useRef)(r&&void 0!==r.showDirectories?r.showDirectories:x.defaultSettings.showDirectories),re=(0,n.useRef)(r&&void 0!==r.showDetails?r.showDetails:x.defaultSettings.showDetails),ne=(0,n.useRef)(r&&void 0!==r.showDescription?r.showDescription:x.defaultSettings.showDescription),oe=(0,n.useRef)(r&&void 0!==r.showEntriesDescription?r.showEntriesDescription:x.defaultSettings.showEntriesDescription),se=(0,n.useRef)(r&&void 0!==r.showTags?r.showTags:x.defaultSettings.showTags),[ie,ae]=(0,n.useState)(!1),[le,ce]=(0,n.useState)(!1),[ue,de]=(0,n.useState)(!1),pe=(0,n.useRef)(r&&r.gridPageLimit?r.gridPageLimit:x.defaultSettings.gridPageLimit),ge=(0,n.useRef)(void 0),[ye,he]=(0,n.useReducer)((e=>e+1),0),fe=(0,Z.Z)(),{classes:me,selectedEntries:Ee,loadParentDirectoryContent:Se,theme:De,currentDirectoryPath:ve}=e;function Te(){e.lastSearchTimestamp?"byRelevance"===V.current?W.current?$.current=G.Z.results:$.current=[...G.Z.results].reverse():$.current=(0,l.sortByCriteria)(e.searchFilter?G.Z.results.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):G.Z.results,V.current,W.current):$.current=(0,l.sortByCriteria)(e.directoryContent,V.current,W.current),he()}(0,n.useEffect)((()=>{1===e.selectedEntries.length&&we()}),[e.selectedEntries]),(0,n.useEffect)((()=>{fe||($.current=(0,l.sortByCriteria)(e.searchFilter?e.directoryContent.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):e.directoryContent,V.current,W.current),he())}),[e.searchFilter]),(0,n.useEffect)((()=>{fe||Te()}),[e.directoryContent,V.current,W.current]),(0,n.useEffect)((()=>{fe||(e.lastSearchTimestamp?V.current="byRelevance":(V.current=r&&r.sortBy?r.sortBy:x.defaultSettings.sortBy,W.current=r&&void 0!==r.orderBy?r.orderBy:x.defaultSettings.orderBy),Te())}),[e.lastSearchTimestamp]),(0,n.useEffect)((()=>{!fe&&e.lastSearchTimestamp&&($.current=G.Z.results,he())}),[e.editedEntryPaths]),(0,n.useEffect)((()=>{if(!fe){const t=H(e.directoryMeta);te.current=t&&void 0!==t.showDirectories?t.showDirectories:x.defaultSettings.showDirectories,ne.current=t&&void 0!==t.showDescription?t.showDescription:x.defaultSettings.showDescription,oe.current=t&&void 0!==t.showEntriesDescription?t.showEntriesDescription:x.defaultSettings.showEntriesDescription,re.current=t&&void 0!==t.showDetails?t.showDetails:x.defaultSettings.showDetails,se.current=t&&void 0!==t.showTags?t.showTags:x.defaultSettings.showTags,q.current=x.defaultSettings.layoutType,W.current=t&&void 0!==t.orderBy?t.orderBy:x.defaultSettings.orderBy,V.current=t&&void 0!==t.sortBy?t.sortBy:x.defaultSettings.sortBy,Q.current=t&&void 0!==t.singleClickAction?t.singleClickAction:x.defaultSettings.singleClickAction,_.current=t&&void 0!==t.entrySize?t.entrySize:x.defaultSettings.entrySize,ee.current=t&&void 0!==t.thumbnailMode?t.thumbnailMode:x.defaultSettings.thumbnailMode,pe.current=t&&void 0!==t.gridPageLimit?t.gridPageLimit:x.defaultSettings.gridPageLimit,he()}}),[e.directoryMeta]),(0,n.useEffect)((()=>{if(!fe&&void 0!==ge.current){const t={showDirectories:te.current,showDescription:ne.current,showEntriesDescription:oe.current,showDetails:re.current,showTags:se.current,layoutType:q.current,orderBy:W.current,sortBy:V.current,singleClickAction:Q.current,entrySize:_.current,thumbnailMode:ee.current,gridPageLimit:pe.current};L.T&&!ge.current?L.T.MetaOperations.savePerspectiveSettings(ve,A.TU.GRID,t).then((t=>{e.setDirectoryMeta(t)})):(localStorage.setItem(x.defaultSettings.settingsKey,JSON.stringify(t)),he()),ge.current=void 0}}),[ge.current,te.current,ne.current,oe.current,re.current,se.current,q.current,W.current,V.current,Q.current,_.current,ee.current,pe.current]);const we=()=>{if(Ee&&Ee.length>0)try{const e=document.querySelector('[data-entry-id="'+Ee[0].uuid+'"]');(0,l.isObj)(e)&&!(0,c.ex)(e)&&e.scrollIntoView(!1)}catch(e){N.debug("makeFirstSelectedEntryVisible:",e)}},Ce=e=>{const t=e?e.currentTarget:null;X(t)},Me=()=>{e.setSelectedEntries([]),d.current=void 0},Re=Ee.length>1,Fe=()=>{Re?Me():e.lastSearchTimestamp?e.setSelectedEntries(G.Z.results):e.setSelectedEntries(e.directoryContent)},Be=()=>{Ze(),te.current=!te.current},be=()=>{Ze(),se.current=!se.current},Le=()=>{Ze();const e="cover"===ee.current?"contain":"cover";return ee.current=e,e},Pe=e=>{Ze(),_.current=e},xe=e=>{Ze(),Q.current=e},Ae=()=>{Ze(),e.openURLExternally(P.Z.documentationLinks.defaultPerspective)},ke=()=>{Ze(),de(!0)},Ge=(e,t,r)=>{e.preventDefault(),e.stopPropagation(),E.current=t,d.current=r,z(e.currentTarget)},Ze=()=>{K(null)},Oe=()=>{ae(!0)},Ne=()=>{e.toggleDeleteMultipleEntriesDialog()},He=()=>{ce(!0)},Ie={nextDocument:e.keyBindings.nextDocument,prevDocument:e.keyBindings.prevDocument,selectAll:e.keyBindings.selectAll,deleteDocument:e.keyBindings.deleteDocument,addRemoveTags:e.keyBindings.addRemoveTags,renameFile:e.keyBindings.renameFile,openEntry:e.keyBindings.openEntry,openFileExternally:e.keyBindings.openFileExternally},ze={nextDocument:()=>e.openNextFile(),prevDocument:()=>e.openPrevFile(),selectAll:()=>Fe(),deleteDocument:()=>{(0,k.eB)(e.selectedEntries)&&Ne()},addRemoveTags:()=>{e.lastSelectedEntryPath&&He()},renameFile:()=>{e.openRenameEntryDialog()},openEntry:t=>{t.preventDefault(),e.openFsEntry()},openFileExternally:()=>{e.openFileNatively()}},Ue=$.current.filter((e=>!e.isFile)),Xe=$.current.filter((e=>e.isFile)),Ye=e.currentLocation?R.Z.getLocationPath(e.currentLocation):"";let Ke=200;return"small"===_.current?Ke=150:"normal"===_.current?Ke=200:"big"===_.current&&(Ke=300),n.createElement("div",{style:{height:"calc(100% - 48px)"},"data-tid":x.defaultSettings.testID},n.createElement(T.Z,{classes:me,layoutType:q.current,isReadOnlyMode:e.isReadOnlyMode,selectedEntries:Ee,loadParentDirectoryContent:Se,toggleSelectAllFiles:Fe,someFileSelected:Re,handleLayoutSwitch:e=>{q.current=e},openAddRemoveTagsDialog:He,fileOperationsEnabled:(0,k.eB)(e.selectedEntries),openMoveCopyFilesDialog:Oe,openDeleteFileDialog:Ne,openFsEntry:e.openFsEntry,handleSortingMenu:Ce,handleExportCsvMenu:()=>{L.T&&L.T.exportAsCsv.ExportAsCsv(e.directoryContent)},openSettings:ke,directoryPath:ve}),n.createElement(i.GlobalHotKeys,{keyMap:Ie,handlers:ze,allowChanges:!0},n.createElement(F.Z,{gridPageLimit:pe.current,style:{margin:0,display:"grid",gridGap:"5px 5px",padding:5,paddingBottom:10,gridTemplateColumns:"repeat(auto-fit,minmax("+Ke+"px,1fr))"},classes:me,theme:De,directories:Ue,showDetails:re.current,showDescription:ne.current,showDirectories:te.current,isReadOnlyMode:e.isReadOnlyMode,layoutType:q.current,desktopMode:e.desktopMode,openRenameEntryDialog:e.openRenameEntryDialog,showTags:se.current,thumbnailMode:ee.current,entrySize:_.current,files:Xe,getCellContent:(t,r,o,i,a,l,c)=>{let d=!1;return r&&r.some((e=>e.path===t.path))&&(d=!0),n.createElement(m.Z,{entryPath:t.path,selectedEntries:r.length>0?r:[t]},n.createElement(v.Z,{selected:d,fsEntry:t,showEntriesDescription:oe.current,entrySize:_.current,classes:me,isLast:c,theme:De,supportedFileTypes:e.supportedFileTypes,thumbnailMode:ee.current,addTags:e.addTags,addTag:e.addTag,selectedEntries:r,selectEntry:t=>{e.setSelectedEntries([...r,t])},deselectEntry:t=>{const n=r.filter((e=>e.path!==t.path));e.setSelectedEntries(n)},isReadOnlyMode:e.isReadOnlyMode,handleTagMenu:Ge,layoutType:q.current,showTags:se.current,openFsEntry:e.openFsEntry,handleGridContextMenu:(e,t)=>{s(e.clientX),u(e.clientY),i(e,t)},handleGridCellDblClick:l,handleGridCellClick:a}))},currentPage:1,currentLocationPath:Ye,currentDirectoryPath:e.currentDirectoryPath,onClick:t=>{t.preventDefault(),e.selectedEntries.length>0&&e.setSelectedEntries([])},onContextMenu:t=>{t.preventDefault(),s(t.clientX),u(t.clientY),e.selectedEntries.length>0&&e.setSelectedEntries([]),O(t.currentTarget)},settings:r,selectedEntries:e.selectedEntries,setSelectedEntries:e.setSelectedEntries,singleClickAction:Q.current,currentLocation:e.currentLocation,directoryContent:e.directoryContent,supportedFileTypes:e.supportedFileTypes,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,setFileContextMenuAnchorEl:D,setDirContextMenuAnchorEl:O,showNotification:e.showNotification,moveFiles:e.moveFiles,clearSelection:Me})),le&&n.createElement(h.Z,{open:le,onClose:()=>ce(!1),addTags:e.addTags,removeTags:e.removeTags,removeAllTags:e.removeAllTags,selectedEntries:e.selectedEntries}),void 0!==J&&n.createElement(b.Z,{open:!0,onClose:()=>j(void 0),addTag:e.addTag,selectedTag:J}),ue&&n.createElement(B.Z,{open:ue,onClose:e=>{de(!1),ge.current=e},setGridPageLimit:e=>{pe.current=e},gridPageLimit:pe.current,toggleShowDirectories:Be,toggleShowTags:be,toggleShowDetails:()=>{Ze(),re.current=!re.current},toggleShowDescription:()=>{Ze(),ne.current=!ne.current},toggleShowEntriesDescription:()=>{Ze(),oe.current=!oe.current},showDetails:re.current,showDescription:ne.current,showEntriesDescription:oe.current,showDirectories:te.current,showTags:se.current,toggleThumbnailsMode:Le,thumbnailMode:ee.current,changeEntrySize:Pe,entrySize:_.current,changeSingleClickAction:xe,singleClickAction:Q.current,openHelpWebPage:Ae,sortBy:V.current,orderBy:W.current,handleSortingMenu:Ce,isLocal:t,resetLocalSettings:()=>{L.T.MetaOperations.savePerspectiveSettings(ve,A.TU.GRID).then((t=>{e.setDirectoryMeta(t),de(!1)}))}}),ie&&n.createElement(f.Z,{open:ie,onClose:()=>ae(!1)}),Boolean(S)&&n.createElement(p.Z,{anchorEl:S,mouseX:o,mouseY:a,open:Boolean(S),onClose:()=>D(null),openDeleteFileDialog:Ne,openRenameFileDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Oe,openAddRemoveTagsDialog:He,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,showInFileManager:e.showInFileManager,showNotification:e.showNotification,isReadOnlyMode:e.isReadOnlyMode,selectedFilePath:e.lastSelectedEntryPath,selectedEntries:e.selectedEntries,currentLocation:e.currentLocation,locations:e.locations}),n.createElement(g.Z,{open:Boolean(M),onClose:()=>O(null),anchorEl:M,mouseX:o,mouseY:a,directoryPath:e.lastSelectedEntryPath,loadDirectoryContent:e.loadDirectoryContent,openRenameDirectoryDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Oe,openDirectory:e.openDirectory,openFsEntry:e.openFsEntry,perspectiveMode:e.lastSelectedEntryPath!==e.currentDirectoryPath,currentLocation:e.currentLocation,locations:e.locations}),n.createElement(y.Z,{anchorEl:I,open:Boolean(I),onClose:()=>z(null),setIsAddTagDialogOpened:j,selectedTag:E.current,currentEntryPath:d.current,removeTags:e.removeTags,isReadOnlyMode:e.isReadOnlyMode}),Boolean(U)&&n.createElement(w.Z,{open:Boolean(U),onClose:()=>X(null),anchorEl:U,sortBy:V.current,orderBy:W.current,handleSortBy:e=>{V.current!==e?V.current=e:W.current=!W.current,X(null)},searchModeEnabled:void 0!==e.lastSearchTimestamp}),Boolean(Y)&&n.createElement(C.Z,{open:Boolean(Y),onClose:Ze,anchorEl:Y,toggleShowDirectories:Be,showDirectories:te.current,toggleShowTags:be,showTags:se.current,toggleThumbnailsMode:Le,thumbnailMode:ee.current,entrySize:_.current,changeSingleClickAction:xe,singleClickAction:Q.current,changeEntrySize:Pe,openHelpWebPage:Ae,openSettings:ke}))}function z(e){return(0,s.DE)({moveFiles:E.Z.moveFiles,setSelectedEntries:S.Nw.setSelectedEntries,showNotification:S.Nw.showNotification,openFileNatively:S.Nw.openFileNatively,openURLExternally:S.Nw.openURLExternally,openNextFile:S.Nw.openNextFile,openPrevFile:S.Nw.openPrevFile,setDirectoryMeta:S.Nw.setDirectoryMeta,toggleDeleteMultipleEntriesDialog:S.Nw.toggleDeleteMultipleEntriesDialog,addTags:D.Z.addTags,addTag:S.Nw.addTag},e)}function U(e){return{directoryMeta:(0,S.ah)(e),supportedFileTypes:(0,u.M3)(e),isReadOnlyMode:(0,S.vo)(e),lastSelectedEntry:(0,S.ww)(e),desktopMode:(0,u.HK)(e),selectedEntries:(0,S.lv)(e),lastSelectedEntryPath:(0,S.Fv)(e),keyBindings:(0,u.PP)(e),currentLocation:(0,M.k$)(e,e.app.currentLocationId),locations:(0,M.JC)(e),isDeleteMultipleEntriesDialogOpened:(0,S.HT)(e),searchFilter:(0,S.QT)(e),editedEntryPaths:(0,S.OB)(e)}}(O="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&O(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(I,"useState{[mouseX, setMouseX](undefined)}\nuseState{[mouseY, setMouseY](undefined)}\nuseRef{selectedEntryPath}\nuseRef{selectedTag}\nuseState{[fileContextMenuAnchorEl, setFileContextMenuAnchorEl](null)}\nuseState{[dirContextMenuAnchorEl, setDirContextMenuAnchorEl](null)}\nuseState{[tagContextMenuAnchorEl, setTagContextMenuAnchorEl](null)}\nuseState{[sortingContextMenuAnchorEl, setSortingContextMenuAnchorEl](null)}\nuseState{[optionsContextMenuAnchorEl, setOptionsContextMenuAnchorEl](null)}\nuseState{[isAddTagDialogOpened, setIsAddTagDialogOpened](undefined)}\nuseRef{sortBy}\nuseRef{orderBy}\nuseRef{sortedDirContent}\nuseRef{layoutType}\nuseRef{singleClickAction}\nuseRef{entrySize}\nuseRef{thumbnailMode}\nuseRef{showDirectories}\nuseRef{showDetails}\nuseRef{showDescription}\nuseRef{showEntriesDescription}\nuseRef{showTags}\nuseState{[isMoveCopyFilesDialogOpened, setIsMoveCopyFilesDialogOpened](false)}\nuseState{[isAddRemoveTagsDialogOpened, setIsAddRemoveTagsDialogOpened](false)}\nuseState{[isGridSettingsDialogOpened, setIsGridSettingsDialogOpened](false)}\nuseRef{gridPageLimit}\nuseRef{isDefaultSetting}\nuseReducer{[ignored, forceUpdate](0)}\nuseFirstRender{firstRender}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(()=>[Z.Z]));const X=(0,o.$j)(U,z)((0,a.Z)(d.Z,{withTheme:!0})(I)),Y=X;var K,J;(K="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(K.register(H,"getSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),K.register(I,"GridPerspective","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),K.register(z,"mapActionCreatorsToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),K.register(U,"mapStateToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),K.register(X,"default","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx")),(J="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&J(e)},19990:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o.Z,defaultSettings:()=>s});var n,o=r(55484);e=r.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s={testID:"gridPerspectiveContainer",settingsKey:"tsPerspectiveGrid",orderBy:!0,sortBy:"byName",layoutType:"grid",singleClickAction:"openInternal",entrySize:"small",thumbnailMode:"contain",showDirectories:!0,showDetails:!0,showDescription:!1,showEntriesDescription:!0,showTags:!0,gridPageLimit:100};var i,a;(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&i.register(s,"defaultSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/index.tsx"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&a(e)}}]);
//# sourceMappingURL=1502.bundle.js.map