"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[9055],{13899:(e,t,n)=>{n.d(t,{Z:()=>Y});var r=n(67294),o=n(24011),s=n(14890),i=n(63274),a=n(61366),l=n(5934),c=n(77297),u=n(74008),d=n(81034),g=n(11157),p=n(52835),y=n(39905),h=n(75708),f=n(98049),S=n(65914),E=n(51405),m=n(44187),D=n(170),v=n(94898),T=n(36146),w=n(54820),C=n(31300),M=n(61284),F=n(36808),R=n(26651),L=n(19412),b=n(54767),B=n(94315),P=n(310),A=n(99765),x=n(4137),k=n(94968),Z=n(36374),O=n(65186);e=n.hmd(e);var N,G=n(25108);function H(e){return B.T&&e&&e.perspectiveSettings&&e.perspectiveSettings[x.TU.LIST]?e.perspectiveSettings[x.TU.LIST]:JSON.parse(localStorage.getItem(A.defaultSettings.settingsKey))}function I(e){const t=B.T&&e.directoryMeta&&e.directoryMeta.perspectiveSettings&&e.directoryMeta.perspectiveSettings[x.TU.LIST],n=H(e.directoryMeta),[o,s]=(0,r.useState)(void 0),[a,u]=(0,r.useState)(void 0),d=(0,r.useRef)(void 0),E=(0,r.useRef)(null),[m,D]=(0,r.useState)(null),[M,N]=(0,r.useState)(null),[I,z]=(0,r.useState)(null),[U,X]=(0,r.useState)(null),[Y,K]=(0,r.useState)(null),[J,j]=(0,r.useState)(void 0),V=(0,r.useRef)(n&&n.sortBy?n.sortBy:A.defaultSettings.sortBy),W=(0,r.useRef)(n&&void 0!==n.orderBy?n.orderBy:A.defaultSettings.orderBy),$=(0,r.useRef)(e.lastSearchTimestamp?Z.Z.results:e.directoryContent),q=(0,r.useRef)(n&&n.layoutType?n.layoutType:A.defaultSettings.layoutType),Q=(0,r.useRef)(n&&n.singleClickAction?n.singleClickAction:A.defaultSettings.singleClickAction),_=(0,r.useRef)(n&&n.entrySize?n.entrySize:A.defaultSettings.entrySize),ee=(0,r.useRef)(n&&n.thumbnailMode?n.thumbnailMode:A.defaultSettings.thumbnailMode),te=(0,r.useRef)(n&&void 0!==n.showDirectories?n.showDirectories:A.defaultSettings.showDirectories),ne=(0,r.useRef)(n&&void 0!==n.showDetails?n.showDetails:A.defaultSettings.showDetails),re=(0,r.useRef)(n&&void 0!==n.showDescription?n.showDescription:A.defaultSettings.showDescription),oe=(0,r.useRef)(n&&void 0!==n.showEntriesDescription?n.showEntriesDescription:A.defaultSettings.showEntriesDescription),se=(0,r.useRef)(n&&void 0!==n.showTags?n.showTags:A.defaultSettings.showTags),[ie,ae]=(0,r.useState)(!1),[le,ce]=(0,r.useState)(!1),[ue,de]=(0,r.useState)(!1),ge=(0,r.useRef)(n&&n.gridPageLimit?n.gridPageLimit:A.defaultSettings.gridPageLimit),pe=(0,r.useRef)(void 0),[ye,he]=(0,r.useReducer)((e=>e+1),0),fe=(0,O.Z)(),{classes:Se,selectedEntries:Ee,loadParentDirectoryContent:me,theme:De,currentDirectoryPath:ve}=e;function Te(){e.lastSearchTimestamp?"byRelevance"===V.current?W.current?$.current=Z.Z.results:$.current=[...Z.Z.results].reverse():$.current=(0,l.sortByCriteria)(e.searchFilter?Z.Z.results.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):Z.Z.results,V.current,W.current):$.current=(0,l.sortByCriteria)(e.directoryContent,V.current,W.current),he()}(0,r.useEffect)((()=>{1===e.selectedEntries.length&&we()}),[e.selectedEntries]),(0,r.useEffect)((()=>{fe||($.current=(0,l.sortByCriteria)(e.searchFilter?e.directoryContent.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):e.directoryContent,V.current,W.current),he())}),[e.searchFilter]),(0,r.useEffect)((()=>{fe||Te()}),[e.directoryContent,V.current,W.current]),(0,r.useEffect)((()=>{fe||(e.lastSearchTimestamp?V.current="byRelevance":(V.current=n&&n.sortBy?n.sortBy:A.defaultSettings.sortBy,W.current=n&&void 0!==n.orderBy?n.orderBy:A.defaultSettings.orderBy),Te())}),[e.lastSearchTimestamp]),(0,r.useEffect)((()=>{!fe&&e.lastSearchTimestamp&&($.current=Z.Z.results,he())}),[e.editedEntryPaths]),(0,r.useEffect)((()=>{if(!fe){const t=H(e.directoryMeta);te.current=t&&void 0!==t.showDirectories?t.showDirectories:A.defaultSettings.showDirectories,re.current=t&&void 0!==t.showDescription?t.showDescription:A.defaultSettings.showDescription,oe.current=t&&void 0!==t.showEntriesDescription?t.showEntriesDescription:A.defaultSettings.showEntriesDescription,ne.current=t&&void 0!==t.showDetails?t.showDetails:A.defaultSettings.showDetails,se.current=t&&void 0!==t.showTags?t.showTags:A.defaultSettings.showTags,q.current=A.defaultSettings.layoutType,W.current=t&&void 0!==t.orderBy?t.orderBy:A.defaultSettings.orderBy,V.current=t&&void 0!==t.sortBy?t.sortBy:A.defaultSettings.sortBy,Q.current=t&&void 0!==t.singleClickAction?t.singleClickAction:A.defaultSettings.singleClickAction,_.current=t&&void 0!==t.entrySize?t.entrySize:A.defaultSettings.entrySize,ee.current=t&&void 0!==t.thumbnailMode?t.thumbnailMode:A.defaultSettings.thumbnailMode,ge.current=t&&void 0!==t.gridPageLimit?t.gridPageLimit:A.defaultSettings.gridPageLimit,he()}}),[e.directoryMeta]),(0,r.useEffect)((()=>{if(!fe&&void 0!==pe.current){const t={showDirectories:te.current,showDescription:re.current,showEntriesDescription:oe.current,showDetails:ne.current,showTags:se.current,layoutType:q.current,orderBy:W.current,sortBy:V.current,singleClickAction:Q.current,entrySize:_.current,thumbnailMode:ee.current,gridPageLimit:ge.current};B.T&&!pe.current?B.T.MetaOperations.savePerspectiveSettings(ve,x.TU.LIST,t).then((t=>{e.setDirectoryMeta(t)})):(localStorage.setItem(A.defaultSettings.settingsKey,JSON.stringify(t)),he()),pe.current=void 0}}),[pe.current,te.current,re.current,oe.current,ne.current,se.current,q.current,W.current,V.current,Q.current,_.current,ee.current,ge.current]);const we=()=>{if(Ee&&Ee.length>0)try{const e=document.querySelector('[data-entry-id="'+Ee[0].uuid+'"]');(0,l.isObj)(e)&&!(0,c.ex)(e)&&e.scrollIntoView(!1)}catch(e){G.debug("makeFirstSelectedEntryVisible:",e)}},Ce=e=>{const t=e?e.currentTarget:null;X(t)},Me=()=>{e.setSelectedEntries([]),d.current=void 0},Fe=Ee.length>1,Re=()=>{Fe?Me():e.lastSearchTimestamp?e.setSelectedEntries(Z.Z.results):e.setSelectedEntries(e.directoryContent)},Le=()=>{Oe(),te.current=!te.current},be=()=>{Oe(),se.current=!se.current},Be=()=>{Oe();const e="cover"===ee.current?"contain":"cover";return ee.current=e,e},Pe=e=>{Oe(),_.current=e},Ae=e=>{Oe(),Q.current=e},xe=()=>{Oe(),e.openURLExternally(P.Z.documentationLinks.defaultPerspective)},ke=()=>{Oe(),de(!0)},Ze=(e,t,n)=>{e.preventDefault(),e.stopPropagation(),E.current=t,d.current=n,z(e.currentTarget)},Oe=()=>{K(null)},Ne=()=>{ae(!0)},Ge=()=>{e.toggleDeleteMultipleEntriesDialog()},He=()=>{ce(!0)},Ie={nextDocument:e.keyBindings.nextDocument,prevDocument:e.keyBindings.prevDocument,selectAll:e.keyBindings.selectAll,deleteDocument:e.keyBindings.deleteDocument,addRemoveTags:e.keyBindings.addRemoveTags,renameFile:e.keyBindings.renameFile,openEntry:e.keyBindings.openEntry,openFileExternally:e.keyBindings.openFileExternally},ze={nextDocument:()=>e.openNextFile(),prevDocument:()=>e.openPrevFile(),selectAll:()=>Re(),deleteDocument:()=>{(0,k.eB)(e.selectedEntries)&&Ge()},addRemoveTags:()=>{e.lastSelectedEntryPath&&He()},renameFile:()=>{e.openRenameEntryDialog()},openEntry:t=>{t.preventDefault(),e.openFsEntry()},openFileExternally:()=>{e.openFileNatively()}},Ue=Ee?Ee.filter((e=>e.isFile)).map((e=>e.path)):[],Xe=$.current.filter((e=>!e.isFile)),Ye=$.current.filter((e=>e.isFile)),Ke=e.currentLocation?F.Z.getLocationPath(e.currentLocation):"";let Je=200;return"small"===_.current?Je=150:"normal"===_.current?Je=200:"big"===_.current&&(Je=300),r.createElement("div",{style:{height:"calc(100% - 48px)"},"data-tid":A.defaultSettings.testID},r.createElement(T.Z,{classes:Se,layoutType:q.current,isReadOnlyMode:e.isReadOnlyMode,selectedEntries:Ee,loadParentDirectoryContent:me,toggleSelectAllFiles:Re,someFileSelected:Fe,handleLayoutSwitch:e=>{q.current=e},openAddRemoveTagsDialog:He,fileOperationsEnabled:(0,k.eB)(e.selectedEntries),openMoveCopyFilesDialog:Ne,openDeleteFileDialog:Ge,openFsEntry:e.openFsEntry,handleSortingMenu:Ce,handleExportCsvMenu:()=>{B.T&&B.T.exportAsCsv.ExportAsCsv(e.directoryContent)},openSettings:ke,directoryPath:ve}),r.createElement(i.GlobalHotKeys,{keyMap:Ie,handlers:ze,allowChanges:!0},r.createElement(R.Z,{gridPageLimit:ge.current,style:{marginTop:5,paddingRight:4,paddingLeft:4,gridTemplateColumns:"none"},classes:Se,theme:De,directories:Xe,showDetails:ne.current,showDescription:re.current,showDirectories:te.current,isReadOnlyMode:e.isReadOnlyMode,layoutType:q.current,desktopMode:e.desktopMode,openRenameEntryDialog:e.openRenameEntryDialog,showTags:se.current,thumbnailMode:ee.current,entrySize:_.current,files:Ye,getCellContent:(t,n,o,i,a,l,c)=>{let d=!1;return n&&n.some((e=>e.path===t.path))&&(d=!0),r.createElement(S.Z,{entryPath:t.path,selectedEntries:n.length>0?n:[t]},r.createElement(v.Z,{selected:d,fsEntry:t,showEntriesDescription:oe.current,entrySize:_.current,classes:Se,isLast:c,theme:De,supportedFileTypes:e.supportedFileTypes,thumbnailMode:ee.current,addTags:e.addTags,addTag:e.addTag,selectedEntries:n,selectEntry:t=>{e.setSelectedEntries([...n,t])},deselectEntry:t=>{const r=n.filter((e=>e.path!==t.path));e.setSelectedEntries(r)},isReadOnlyMode:e.isReadOnlyMode,handleTagMenu:Ze,layoutType:q.current,showTags:se.current,openFsEntry:e.openFsEntry,handleGridContextMenu:(e,t)=>{s(e.clientX),u(e.clientY),i(e,t)},handleGridCellDblClick:l,handleGridCellClick:a}))},currentPage:1,currentLocationPath:Ke,currentDirectoryPath:e.currentDirectoryPath,onClick:t=>{t.preventDefault(),e.selectedEntries.length>0&&e.setSelectedEntries([])},onContextMenu:t=>{t.preventDefault(),s(t.clientX),u(t.clientY),e.selectedEntries.length>0&&e.setSelectedEntries([]),N(t.currentTarget)},settings:n,selectedEntries:e.selectedEntries,setSelectedEntries:e.setSelectedEntries,singleClickAction:Q.current,currentLocation:e.currentLocation,directoryContent:e.directoryContent,supportedFileTypes:e.supportedFileTypes,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,setFileContextMenuAnchorEl:D,setDirContextMenuAnchorEl:N,showNotification:e.showNotification,moveFiles:e.moveFiles,clearSelection:Me})),le&&r.createElement(h.Z,{open:le,onClose:()=>ce(!1),addTags:e.addTags,removeTags:e.removeTags,removeAllTags:e.removeAllTags,selectedEntries:e.selectedEntries}),void 0!==J&&r.createElement(b.Z,{open:!0,onClose:()=>j(void 0),addTag:e.addTag,selectedTag:J}),ue&&r.createElement(L.Z,{open:ue,onClose:e=>{de(!1),pe.current=e},setGridPageLimit:e=>{ge.current=e},gridPageLimit:ge.current,toggleShowDirectories:Le,toggleShowTags:be,toggleShowDetails:()=>{Oe(),ne.current=!ne.current},toggleShowDescription:()=>{Oe(),re.current=!re.current},toggleShowEntriesDescription:()=>{Oe(),oe.current=!oe.current},showDetails:ne.current,showDescription:re.current,showEntriesDescription:oe.current,showDirectories:te.current,showTags:se.current,toggleThumbnailsMode:Be,thumbnailMode:ee.current,changeEntrySize:Pe,entrySize:_.current,changeSingleClickAction:Ae,singleClickAction:Q.current,openHelpWebPage:xe,sortBy:V.current,orderBy:W.current,handleSortingMenu:Ce,isLocal:t,resetLocalSettings:()=>{B.T.MetaOperations.savePerspectiveSettings(ve,x.TU.LIST).then((t=>{e.setDirectoryMeta(t),de(!1)}))}}),ie&&r.createElement(f.Z,{open:ie,onClose:()=>ae(!1),selectedFiles:Ue}),Boolean(m)&&r.createElement(g.Z,{anchorEl:m,mouseX:o,mouseY:a,open:Boolean(m),onClose:()=>D(null),openDeleteFileDialog:Ge,openRenameFileDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Ne,openAddRemoveTagsDialog:He,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,showInFileManager:e.showInFileManager,showNotification:e.showNotification,isReadOnlyMode:e.isReadOnlyMode,selectedFilePath:e.lastSelectedEntryPath,selectedEntries:e.selectedEntries,currentLocation:e.currentLocation,locations:e.locations}),r.createElement(p.Z,{open:Boolean(M),onClose:()=>N(null),anchorEl:M,mouseX:o,mouseY:a,directoryPath:e.lastSelectedEntryPath,loadDirectoryContent:e.loadDirectoryContent,openRenameDirectoryDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Ne,openDirectory:e.openDirectory,openFsEntry:e.openFsEntry,perspectiveMode:e.lastSelectedEntryPath!==e.currentDirectoryPath,currentLocation:e.currentLocation,locations:e.locations}),r.createElement(y.Z,{anchorEl:I,open:Boolean(I),onClose:()=>z(null),setIsAddTagDialogOpened:j,selectedTag:E.current,currentEntryPath:d.current,removeTags:e.removeTags,isReadOnlyMode:e.isReadOnlyMode}),Boolean(U)&&r.createElement(w.Z,{open:Boolean(U),onClose:()=>X(null),anchorEl:U,sortBy:V.current,orderBy:W.current,handleSortBy:e=>{V.current!==e?V.current=e:W.current=!W.current,X(null)},searchModeEnabled:void 0!==e.lastSearchTimestamp}),Boolean(Y)&&r.createElement(C.Z,{open:Boolean(Y),onClose:Oe,anchorEl:Y,toggleShowDirectories:Le,showDirectories:te.current,toggleShowTags:be,showTags:se.current,toggleThumbnailsMode:Be,thumbnailMode:ee.current,entrySize:_.current,changeSingleClickAction:Ae,singleClickAction:Q.current,changeEntrySize:Pe,openHelpWebPage:xe,openSettings:ke}))}function z(e){return(0,s.DE)({moveFiles:E.Z.moveFiles,setSelectedEntries:m.Nw.setSelectedEntries,showNotification:m.Nw.showNotification,openFileNatively:m.Nw.openFileNatively,openURLExternally:m.Nw.openURLExternally,openNextFile:m.Nw.openNextFile,openPrevFile:m.Nw.openPrevFile,setDirectoryMeta:m.Nw.setDirectoryMeta,toggleDeleteMultipleEntriesDialog:m.Nw.toggleDeleteMultipleEntriesDialog,addTags:D.Z.addTags,addTag:m.Nw.addTag},e)}function U(e){return{directoryMeta:(0,m.ah)(e),supportedFileTypes:(0,u.M3)(e),isReadOnlyMode:(0,m.vo)(e),lastSelectedEntry:(0,m.ww)(e),desktopMode:(0,u.HK)(e),selectedEntries:(0,m.lv)(e),lastSelectedEntryPath:(0,m.Fv)(e),keyBindings:(0,u.PP)(e),currentLocation:(0,M.k$)(e,e.app.currentLocationId),locations:(0,M.JC)(e),isDeleteMultipleEntriesDialogOpened:(0,m.HT)(e),searchFilter:(0,m.QT)(e),editedEntryPaths:(0,m.OB)(e)}}(N="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&N(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(I,"useState{[mouseX, setMouseX](undefined)}\nuseState{[mouseY, setMouseY](undefined)}\nuseRef{selectedEntryPath}\nuseRef{selectedTag}\nuseState{[fileContextMenuAnchorEl, setFileContextMenuAnchorEl](null)}\nuseState{[dirContextMenuAnchorEl, setDirContextMenuAnchorEl](null)}\nuseState{[tagContextMenuAnchorEl, setTagContextMenuAnchorEl](null)}\nuseState{[sortingContextMenuAnchorEl, setSortingContextMenuAnchorEl](null)}\nuseState{[optionsContextMenuAnchorEl, setOptionsContextMenuAnchorEl](null)}\nuseState{[isAddTagDialogOpened, setIsAddTagDialogOpened](undefined)}\nuseRef{sortBy}\nuseRef{orderBy}\nuseRef{sortedDirContent}\nuseRef{layoutType}\nuseRef{singleClickAction}\nuseRef{entrySize}\nuseRef{thumbnailMode}\nuseRef{showDirectories}\nuseRef{showDetails}\nuseRef{showDescription}\nuseRef{showEntriesDescription}\nuseRef{showTags}\nuseState{[isMoveCopyFilesDialogOpened, setIsMoveCopyFilesDialogOpened](false)}\nuseState{[isAddRemoveTagsDialogOpened, setIsAddRemoveTagsDialogOpened](false)}\nuseState{[isGridSettingsDialogOpened, setIsGridSettingsDialogOpened](false)}\nuseRef{gridPageLimit}\nuseRef{isDefaultSetting}\nuseReducer{[ignored, forceUpdate](0)}\nuseFirstRender{firstRender}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(()=>[O.Z]));const X=(0,o.$j)(U,z)((0,a.Z)(d.Z,{withTheme:!0})(I)),Y=X;var K,J;(K="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(K.register(H,"getSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),K.register(I,"GridPerspective","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),K.register(z,"mapActionCreatorsToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),K.register(U,"mapStateToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),K.register(X,"default","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx")),(J="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&J(e)},99765:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o.Z,defaultSettings:()=>s});var r,o=n(13899);e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s={testID:"listPerspectiveContainer",settingsKey:"tsPerspectiveList",orderBy:!0,sortBy:"byName",layoutType:"row",singleClickAction:"openInternal",entrySize:"small",thumbnailMode:"contain",showDirectories:!0,showDetails:!0,showDescription:!1,showEntriesDescription:!0,showTags:!0,gridPageLimit:100};var i,a;(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&i.register(s,"defaultSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/index.tsx"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&a(e)}}]);
//# sourceMappingURL=9055.bundle.js.map